<table class="sourcetable"><tr><td><div class="linenodiv" style="background-color: #f0f0f0; padding-right: 10px"><pre style="line-height: 125%"> 1
 2
 3
 4
 5
 6
 7
 8
 9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27</pre></div></td><td class="code"><div class="source" style="background: #f8f8f8"><pre style="line-height: 125%"><span></span>    <span style="color: #008000; font-weight: bold">def</span> <span style="color: #0000FF">validate</span>(<span style="color: #008000">self</span>):
        check_validate <span style="color: #666666">=</span> <span style="color: #008000">super</span>(BatchEnrollmentForm, <span style="color: #008000">self</span>)<span style="color: #666666">.</span>validate()
        <span style="color: #408080; font-style: italic"># if our validators do not pass</span>
        <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> check_validate:
            <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">False</span>
        <span style="color: #008000; font-weight: bold">try</span>:
            rows <span style="color: #666666">=</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>csv<span style="color: #666666">.</span>data<span style="color: #666666">.</span>splitlines()
            <span style="color: #008000">self</span><span style="color: #666666">.</span>csv<span style="color: #666666">.</span>parsed <span style="color: #666666">=</span> <span style="color: #008000">list</span>(csv<span style="color: #666666">.</span>reader(rows))
        <span style="color: #008000; font-weight: bold">except</span> csv<span style="color: #666666">.</span>error <span style="color: #008000; font-weight: bold">as</span> e:
            logging<span style="color: #666666">.</span>error(e)
            <span style="color: #008000">self</span><span style="color: #666666">.</span>csv<span style="color: #666666">.</span>errors<span style="color: #666666">.</span>append([<span style="color: #BA2121">&#39;The CSV could not be parsed&#39;</span>])
            <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">False</span>

        <span style="color: #008000; font-weight: bold">for</span> row <span style="color: #AA22FF; font-weight: bold">in</span> <span style="color: #008000">self</span><span style="color: #666666">.</span>csv<span style="color: #666666">.</span>parsed:
            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #008000">len</span>(row) <span style="color: #666666">!=</span> <span style="color: #666666">5</span>:
                err <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;{} did not have 5 columns&quot;</span><span style="color: #666666">.</span>format(row)
                <span style="color: #008000">self</span><span style="color: #666666">.</span>csv<span style="color: #666666">.</span>errors<span style="color: #666666">.</span>append(err)
                <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">False</span>
            <span style="color: #008000; font-weight: bold">if</span> <span style="color: #AA22FF; font-weight: bold">not</span> row[<span style="color: #666666">0</span>]:
                err <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;{} did not have an email&quot;</span><span style="color: #666666">.</span>format(row)
                <span style="color: #008000">self</span><span style="color: #666666">.</span>csv<span style="color: #666666">.</span>errors<span style="color: #666666">.</span>append(err)
                <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">False</span>
            <span style="color: #008000; font-weight: bold">elif</span> <span style="color: #BA2121">&quot;@&quot;</span> <span style="color: #AA22FF; font-weight: bold">not</span> <span style="color: #AA22FF; font-weight: bold">in</span> row[<span style="color: #666666">0</span>]:
                <span style="color: #408080; font-style: italic"># TODO : Better email check.</span>
                err <span style="color: #666666">=</span> <span style="color: #BA2121">&quot;{} is not a valid email&quot;</span><span style="color: #666666">.</span>format(row[<span style="color: #666666">0</span>])
                <span style="color: #008000">self</span><span style="color: #666666">.</span>csv<span style="color: #666666">.</span>errors<span style="color: #666666">.</span>append(err)
                <span style="color: #008000; font-weight: bold">return</span> <span style="color: #008000">False</span>
</pre></div>
</td></tr></table>